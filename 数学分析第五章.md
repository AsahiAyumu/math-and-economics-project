**5.1 微分中值定理**

**5.1.1 函数极值与Fermat引理**

**定义5.1.1：** 设$f(x)$在$(a,b)$上有定义，有一点$x_0 \in (a,b)$，如果在该点$x_0$的某个邻域$O(x_0,\delta) \subset (a,b)$，使得$f(x) \leq f(x_0)[x \in O(x_0,\delta)]$成立，则称$x_0$是$f(x)$的一个极大值点，$f(x_0)$称为相应的极大值。

类似地我们可以定义极小值：

设$f(x)$在$(a,b)$上有定义，有一点$x_0 \in (a,b)$，如果该点$x_0$的某个邻域$O(x_0,\delta) \subset (a,b)$，使得$f(x) \geq f(x_0)[x \in O(x_0,\delta)]$成立，则称$x_0$是$f(x)$的一个极小值点，$f(x_0)$称为相应的极小值。【如图所示】
极大值点和极小值点统称为极值点，相对应极大值和极小值统称为极值。上述定义需要注意如下事项：

（1）极大和极小是指在$x_0$附近的一个局部范围中函数值的大小关系。无论邻域的范围大小，只要能够找到存在这么一个邻域能够符合定义，就能说明$x_0$是极大值点或极小值点。注意和最值的概念的区别。（举一个例子：小明是1班的成绩最好的，但这不代表小明是该年级成绩最好的）

（2）在同一区间内，函数的最大值一定大于最小值；但是极大值不一定大于极小值。（因为极大值和极小值都是在各自邻域内是最大值和最小值，而且这两个邻域通常不是同一个区间。举一个例子：同样是高二年级，即使是重点高中的实验班最低分，可能比普通中学的普通版最高分还要高）

（3）$f(x)$在一个区间内极值点可以有无数个，比如$f(x) = \sin{\frac{1}{x}}, x \in (0,1)$。（观察下图，你会发现该函数曲线在上下震荡，且越靠近0震荡程度越密集，当然震荡、震荡频率等话题不包含在本课程的讨论范围之内）

（4）在某个区间内，若$x_0$为$f(x)$的最值点，则$x_0$也一定是$f(x)$的极值点。

**定理5.1.1（Fermat（费马）引理）:** 设$x_0$是$f(x)$的一个极值点，且$f(x)$在$x_0$处导数存在，则$f’(x_0) = 0$。

**证明定理5.1.1：**
【证明思路】根据极限的保号性得到左右导数的正负性，然后根据导数存在的性质得出结论。
 不妨设$x_0$是$f(x)$的极大值点。根据极大值点的定义，在$x_0$的某个邻域上$f(x)$上有定义，且满足：$f(x) \leq f(x_0)$($x$是邻域内任意一点)

 由此得到当$x < x_0$时，$\frac{f(x) - f(x_0)}{x - x_0} \geq 0$；当$x > x_0$时，$\frac{f(x) - f(x_0)}{x - x_0} \leq 0$。

 因为$f(x)$在$x_0$处可导，所以$f’(x_0) = f’_-(x_0) = f’_+(x_0)$。

 由于$f’_-(x_0) = \lim_{x \rightarrow x_0^-} \frac{f(x) - f(x_0)}{x - x_0} \geq 0$，$f’_+(x_0) = \lim_{x \rightarrow x_0^+} \frac{f(x) - f(x_0)}{x - x_0} \leq 0$。

 由此得到$f’(x_0) \geq 0$且$f’(x_0) \leq 0$，由此证得$f’(x_0) = 0$。
 同理可以证明$x_0$为极小值的情形。	$\blacksquare$

 Fermat引理的几何意义是：若曲线$f(x)$在其极值点处可导，即在该点存在切线，则该切线一定平行于$x$轴（因为该点导数为0）。

 **注释：**
 （1）若函数$f(x)$在$x_0$处的导数为0，是不能推出“该点为极值点”这一结论的。比如$f(x) = x^3$在$x_0=0$这一点的导数为0，但该点并不是$f(x)$的极值点，因为在该点的任意邻域$I = O(x_0,\delta)$内，无论$\delta$取何值，总是有存在$x \in I$，使得$f(x) \leq f(x_0)$或者$f(x) \geq f(x_0)$成立。

 （2）极值点的存在性与函数的可导性没有任何关系。若函数$f(x)$在$x_0$取得极值，这不能说明$f’(x_0) = 0$，因为这一结论的前提是$f(x)$在$x_0$处可导。


**5.1.2 Rolle定理**

**定理5.1.2（Rolle（罗尔）定理）:** 设函数$f(x)$在闭区间$[a,b]$上连续，在开区间$(a,b)$上可导，且$f(a) = f(b)$，则至少存在一个点$\xi \in (a,b)$，使得$f’(\xi) = 0$。

**证明定理5.1.2：**

【证明思路】根据最值定理设最大值和最小值，并且找出极大值点使用费马引理

由于闭区间上连续函数的性质（最值定理），存在$\xi, \eta \in [a,b]$，满足$f(\xi) = M, f(\eta) =m$，其中$M$和$m$分别为$f(x)$在区间$[a,b]$上的最大值和最小值。

若$M = m$，此时$f(x)$在$[a,b]$上恒为常数，结论显然成立；

若$M \neq m$，此时在$M$和$m$中至少有一个与$f(a)$和$f(b)$都不同（由于$f(a) = f(b)$，且$m \neq M$，所以如果最大值取在端点$a$和$b$上，那么最小值一定不在端点上而存在于区间$(a,b)$之内；反之，如果最小值取在端点$a$和$b$上，那么最大值一定不在端点上而存在于区间$(a,b)$之内。由此可以得到在区间$(a,b)$内一定有一个极值点）

不妨设$M = f(\xi) > f(a) = (b)$

因此$\xi \in (a,b)$显然是$f(x)$的最大值点，根据Fermat引理，$f’(\xi) = 0$。

这里也可以通过极小值点来证明，证明过程类似。

**注释：**

Rolle定理的三个条件缺一不可（闭区间连续，开区间可导，端点函数值相等）。缺少一个都会导致结论不成立。

**例5.1.1:** 定义一个函数：
$p_n(x) = \frac{1}{2^n n!} \frac{d^n}{d x^n} (n=0,1,2,\dots)$
这种函数被称为$n$次的Legendre多项式（勒让德多项式）。证明$p_n(x)$在$(-1,1)$上恰有$n$个不同的根。

**证明：**

【留空】

**5.1.3 Lagrange中值定理**

我们来思考一下，在Rolle定理中第三个条件不成立，即不再规定端点函数值相等，那么我们会得到什么样的结论？我们将会得到Lagrange中值定理。

**定理5.1.3（Lagrange（拉格朗日）中值定理）：** 设函数$f(x)$在闭区间$[a,b]$上连续，在开区间$(a,b)$上可导，则至少存在一点$\xi \in (a,b)$，使得$f'(\xi) = \frac{f(b) - f(a)}{b - a}$。

**证明定理5.1.3：**

【证明思路】Lagrange中值定理的证明需要通过Rolle中值定理来证明。

设辅助函数$g(x) = f(x) - f(b) - \frac{f(b) - f(a)}{b - a}(x - a), x \in [a,b]$

由于函数$f(x)$在闭区间$[a,b]$上连续，在开区间$(a,b)$上可导，因此函数$g(x)$也在闭区间$[a,b]$上连续，也在开区间$(a,b)$上可导。同时$g(a) = g(b) = f(a) - f(b)$，根据Rolle定理，得到结论：

至少存在一个点$\xi \in (a,b)$，使得$g'(\xi) = 0$。

因为$g'(x) = f'(x) - \frac{f(b) - f(a)}{b - a}$，所以$g'(\xi) = f'(x) - \frac{f(b) - f(a)}{b - a} = 0 \Rightarrow f'(\xi) = \frac{f(b) - f(a)}{b - a}。$		$\blacksquare$

我们可以从函数图像的角度来理解上面的证明过程：



